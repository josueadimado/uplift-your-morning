{% extends 'base.html' %}

{% block title %}{{ event.title }} - Upcoming Event | Uplift Your Morning{% endblock %}

{% block meta_description %}{{ event.description|truncatewords:30|default:"Join us for this upcoming event from Uplift Your Morning." }}{% endblock %}

{% block meta_keywords %}{{ event.title }}, event, prayer gathering, community event, spiritual event{% endblock %}

{% block og_title %}{{ event.title }} - Uplift Your Morning{% endblock %}

{% block og_description %}{{ event.description|truncatewords:30|default:"Join us for this upcoming event designed to inspire and empower." }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <article class="bg-white rounded-lg shadow-md overflow-hidden mb-8">
        {% if event.poster_image %}
        <!-- Large poster image at top -->
        <img src="{{ event.poster_image.url }}"
             alt="{{ event.title }}"
             class="w-full h-64 object-cover">
        {% endif %}
        <div class="p-8">
            <h1 class="text-4xl font-bold mb-4">{{ event.title }}</h1>
            
            <div class="space-y-2 mb-6">
            <p class="text-gray-700">
                <strong>Start:</strong> {{ event.start_datetime|date:"F d, Y g:i A" }}
            </p>
            <p class="text-gray-700">
                <strong>End:</strong> {{ event.end_datetime|date:"F d, Y g:i A" }}
            </p>
            {% if event.location %}
            <p class="text-gray-700">
                <strong>Location:</strong> {{ event.location }}
            </p>
            {% endif %}
            {% if event.is_online %}
            <p class="text-green-600 font-semibold">This is an online event</p>
            {% endif %}
        </div>
        
        <div class="prose max-w-none mb-6">
            <p class="text-gray-700 whitespace-pre-line">{{ event.description }}</p>
        </div>
        
        {% if event.is_online %}
        {% if event.youtube_url or event.facebook_url or event.zoom_url or event.livestream_url %}
        <div class="mb-6 space-y-3">
            <h2 class="text-xl font-semibold mb-2" style="color: var(--text);">Join Live</h2>
            <div class="flex flex-wrap gap-3">
                {% if event.youtube_url %}
                <a href="{{ event.youtube_url }}" target="_blank" rel="noopener noreferrer" 
                   class="inline-flex items-center rounded-lg font-semibold transition-colors shadow-md hover:shadow-lg"
                   style="padding: 10px 20px; background: #FF0000; color: white;">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                    </svg>
                    YouTube Live
                </a>
                {% endif %}
                {% if event.facebook_url %}
                <a href="{{ event.facebook_url }}" target="_blank" rel="noopener noreferrer" 
                   class="inline-flex items-center rounded-lg font-semibold transition-colors shadow-md hover:shadow-lg"
                   style="padding: 10px 20px; background: #1877F2; color: white;">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M24 12.073c0-6.627-5.373-12-12-12S0 5.446 0 12.073C0 18.1 4.388 23.06 10.125 24v-8.385H7.078v-3.542h3.047V9.413c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953h-1.513c-1.492 0-1.956.925-1.956 1.874v2.25h3.328L16.5 15.615h-2.175V24C19.612 23.06 24 18.1 24 12.073z"/>
                    </svg>
                    Facebook Live
                </a>
                {% endif %}
                {% if event.zoom_url %}
                <a href="{{ event.zoom_url }}" target="_blank" rel="noopener noreferrer" 
                   class="inline-flex items-center rounded-lg font-semibold transition-colors shadow-md hover:shadow-lg"
                   style="padding: 10px 20px; background: #2D8CFF; color: white;">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M3 7.5A4.5 4.5 0 017.5 3h5A4.5 4.5 0 0117 7.5V11l3.293-3.293A1 1 0 0122 8.414v7.172a1 1 0 01-1.707.707L17 13v3.5A4.5 4.5 0 0112.5 21h-5A4.5 4.5 0 013 16.5v-9z"/>
                    </svg>
                    Join on Zoom
                </a>
                {% endif %}
                {% if not event.youtube_url and not event.facebook_url and not event.zoom_url and event.livestream_url %}
                <!-- Fallback generic livestream button -->
                <a href="{{ event.livestream_url }}" target="_blank" rel="noopener noreferrer" 
                   class="inline-flex items-center rounded-lg font-semibold transition-colors shadow-md hover:shadow-lg"
                   style="padding: 10px 20px; background: var(--primary); color: white;">
                    Watch Livestream
                </a>
                {% endif %}
            </div>
        </div>
        {% endif %}
        {% endif %}
        </div>
    </article>
    
    <!-- Registration Form -->
    {% if event.registration_open %}
    <div class="bg-white rounded-lg shadow-md p-8">
        <h2 class="text-2xl font-semibold mb-6">Register for This Event</h2>
        <form method="post" class="space-y-4">
            {% csrf_token %}
            <div>
                <label for="full_name" class="block text-sm font-medium text-gray-700 mb-2">Full Name *</label>
                <input type="text" name="full_name" id="full_name" required 
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div>
                <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email *</label>
                <input type="email" name="email" id="email" required 
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div>
                <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                <input type="tel" name="phone" id="phone" 
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div>
                <label for="country" class="block text-sm font-medium text-gray-700 mb-2">Country</label>
                <input type="text" name="country" id="country" 
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div>
                <label for="notes" class="block text-sm font-medium text-gray-700 mb-2">Additional Notes</label>
                <textarea name="notes" id="notes" rows="4" 
                          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
            </div>
            
            <button type="submit"
                    class="w-full text-white px-6 py-3 rounded-lg font-semibold"
                    style="background: var(--primary);">
                Register Now
            </button>
        </form>
    </div>
    {% else %}
    <div class="bg-gray-100 rounded-lg p-6 text-center">
        <p class="text-gray-600">Registration for this event is currently closed.</p>
    </div>
    {% endif %}
</div>
{% endblock %}

